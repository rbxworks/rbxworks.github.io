<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Redeem Promo Code - rbxworks</title>

    <link href="https://fonts.googleapis.com/css2?family=Poppins:wght@300;400;500;600;700&display=swap" rel="stylesheet">

    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.2/css/all.min.css" integrity="sha512-SnH5WK+bZxgPHs44uWIX+LLJAJ9/2PkPKZ5QiAj6Ta86w+fsb2TkcmfRyVX3pBnMFcV7oQPJkl9QevSCWr3W6A==" crossorigin="anonymous" referrerpolicy="no-referrer" />

    <style>
        /* CSS Variables for consistent theme */
        :root {
            --bg-gradient-start: #1f2937;
            --bg-gradient-end: #111827;
            --card-bg: rgba(31, 41, 55, 0.75);
            --accent-color: #38bdf8; /* Primary button */
            --accent-hover: #0ea5e9;
            --secondary-color: #4b5563; /* Secondary button */
            --secondary-hover: #6b7280;
            --text-primary: #f3f4f6;
            --text-secondary: #9ca3af;
            --text-highlight: #fde047; /* Coins */
            --border-color: rgba(107, 114, 128, 0.3);
            --input-bg: rgba(55, 65, 81, 0.5);
            --shadow-color: rgba(0, 0, 0, 0.5);
            --card-blur: 6px;
            --border-radius-main: 12px;
            --border-radius-small: 8px;
            --success-color: #4ade80; /* Light Green */
            --error-color: #f87171; /* Light Red */
        }

        * { margin: 0; padding: 0; box-sizing: border-box; }

        html { height: 100%; }

        body {
            font-family: 'Poppins', sans-serif; /* Use Poppins */
            background: linear-gradient(135deg, var(--bg-gradient-start), var(--bg-gradient-end)) no-repeat center center fixed;
            background-size: cover;
            color: var(--text-primary);
            text-align: center;
            min-height: 100%;
            padding: 20px;
            padding-top: 80px; /* Space for fixed top bar */
            display: flex;
            flex-direction: column;
            align-items: center;
            justify-content: center; /* Center container */
            -webkit-font-smoothing: antialiased;
            -moz-osx-font-smoothing: grayscale;
        }

        /* Consistent Top Bar */
        .top-bar {
            width: 100%; padding: 12px 25px;
            background: rgba(17, 24, 39, 0.9);
            backdrop-filter: blur(var(--card-blur));
            -webkit-backdrop-filter: blur(var(--card-blur));
            border-bottom: 1px solid var(--border-color);
            box-shadow: 0 4px 15px var(--shadow-color);
            position: fixed; top: 0; left: 0; z-index: 100;
            display: flex; justify-content: space-between; align-items: center;
            flex-wrap: wrap; gap: 15px;
        }
        .brand-name { font-weight: 600; font-size: 1.3rem; color: var(--text-primary); }
        .brand-name i { margin-right: 8px; color: var(--accent-color); }
        .coin-balance-display { font-size: 1rem; font-weight: 500; color: var(--text-secondary); }
        .coin-balance-display i { margin-right: 5px; color: var(--text-highlight); }
        .coin-balance-display span { color: var(--text-highlight); font-weight: 700; margin-left: 3px; }

        /* Promo Code Container */
        .container {
            background: var(--card-bg);
            padding: 35px 40px;
            border-radius: var(--border-radius-main);
            box-shadow: 0 8px 32px var(--shadow-color);
            backdrop-filter: blur(var(--card-blur));
            -webkit-backdrop-filter: blur(var(--card-blur));
            border: 1px solid var(--border-color);
            text-align: center;
            max-width: 500px; /* Keep max-width */
            width: 95%; /* More responsive width */
        }

        h1 {
            font-size: 2rem; /* Appropriate size */
            font-weight: 700;
            margin-bottom: 25px; /* More spacing */
            color: var(--text-primary);
            text-shadow: none; /* Remove old shadow */
        }

        .input-box {
            font-family: 'Poppins', sans-serif; /* Use Poppins */
            font-size: 1.1rem; /* Good input size */
            padding: 14px 20px;
            width: 100%; /* Full width */
            border: 1px solid var(--border-color);
            border-radius: var(--border-radius-small);
            outline: none;
            text-align: center;
            background: var(--input-bg);
            color: var(--text-primary);
            box-shadow: none; /* Remove old shadow */
            margin-bottom: 20px; /* Space below input */
            transition: border-color 0.3s ease, box-shadow 0.3s ease;
            text-transform: uppercase; /* Automatically make input uppercase */
        }
         .input-box::placeholder { color: var(--text-secondary); opacity: 0.7; text-transform: none;} /* Placeholder normal case */
         .input-box:focus { border-color: var(--accent-color); box-shadow: 0 0 0 3px rgba(56, 189, 248, 0.3); }


        /* Button Styles */
         .button-group {
             display: flex;
             flex-wrap: wrap; /* Allow buttons to wrap */
             justify-content: center;
             gap: 15px; /* Space between buttons */
             margin-top: 10px;
         }

        .btn {
            font-family: 'Poppins', sans-serif; /* Use Poppins */
            display: inline-flex; align-items: center; justify-content: center; gap: 8px;
            font-size: 1rem; font-weight: 600; padding: 12px 25px;
            border: none; border-radius: var(--border-radius-small);
            cursor: pointer; transition: all 0.3s ease-in-out;
            box-shadow: 0 2px 5px rgba(0, 0, 0, 0.2); /* Subtle shadow */
            flex-grow: 1; /* Allow buttons to grow */
            min-width: 140px; /* Minimum width */
        }

        .btn-primary { /* Redeem button */
             background-color: var(--accent-color); color: var(--bg-gradient-end);
        }
         .btn-primary:hover { background-color: var(--accent-hover); transform: translateY(-2px); box-shadow: 0 4px 10px rgba(56, 189, 248, 0.3); }
         .btn-primary:active { transform: translateY(-1px); }

        .btn-secondary { /* Home button */
            background-color: var(--secondary-color); color: var(--text-primary);
        }
         .btn-secondary:hover { background-color: var(--secondary-hover); transform: translateY(-2px); box-shadow: 0 4px 8px rgba(0, 0, 0, 0.3); }
         .btn-secondary:active { transform: translateY(-1px); }

        /* Message Area */
        .message {
            font-family: 'Poppins', sans-serif; /* Use Poppins */
            font-size: 0.95rem; font-weight: 500;
            margin-top: 25px;
            min-height: 1.5em;
            visibility: hidden; opacity: 0;
            transition: opacity 0.4s ease-in-out, color 0.4s ease;
            text-shadow: none; /* Remove old shadow */
        }
        .message.show { visibility: visible; opacity: 1; }
        .message.success { color: var(--success-color); }
        .message.error { color: var(--error-color); }

         /* Responsive */
        @media (max-width: 500px) {
            body { padding-top: 70px; justify-content: flex-start; }
            .top-bar { padding: 10px 15px; }
            .brand-name { font-size: 1.1rem; }
            .coin-balance-display { font-size: 0.9rem; }
            .container { padding: 25px 20px; margin-top: 20px; width: 95%; }
            h1 { font-size: 1.6rem; margin-bottom: 20px;}
            .input-box { font-size: 1rem; padding: 12px 15px;}
             .button-group { flex-direction: column; align-items: center; } /* Stack buttons */
            .btn { width: 100%; max-width: 300px;} /* Full width buttons when stacked */
             .message { margin-top: 20px; font-size: 0.9rem; }
        }

    </style>
</head>
<body>

    <div class="top-bar">
        <span class="brand-name">
            <i class="fa-solid fa-cubes"></i> rbxworks
        </span>
        <div class="coin-balance-display">
            <i class="fa-solid fa-coins"></i> Your Coins: <span id="topCoinBalance">0</span>
        </div>
    </div>

    <div class="container">
        <h1>Enter Promo Code</h1>
        <input type="text" id="promoCodeInput" class="input-box" placeholder="ENTER CODE">
        <div class="button-group">
             <button type="button" id="redeemButton" class="btn btn-primary">
                  <i class="fa-solid fa-ticket"></i> Redeem
             </button>
             <button type="button" id="homeButton" class="btn btn-secondary">
                  <i class="fa-solid fa-house"></i> Back to Home
             </button>
        </div>
        <p id="messageOutput" class="message"></p> </div>

    <script>
        // Wait for the DOM to be fully loaded
        document.addEventListener('DOMContentLoaded', () => {

            // --- Configuration ---
            // V V V V V V V V V V V V V V V V V V V V V V V V V V V V V V
            // V V V         ADD YOUR PROMO CODES BELOW            V V V
            // V V V V V V V V V V V V V V V V V V V V V V V V V V V V V V
            const validCodes = {
                // --- Start adding codes below this line ---
                "FREEREDEEMCOINS": 5, // <-- This is the only active code. Add comma if you add more lines below it.
                // "ANOTHERCODE": 15,    // <-- Example: Add your next code here with a comma

                // --- Do not edit or add codes below this line ---
                "___PLACEHOLDER___": 0 // Leave this entry last! No comma here.
            };
            // ^ ^ ^ ^ ^ ^ ^ ^ ^ ^ ^ ^ ^ ^ ^ ^ ^ ^ ^ ^ ^ ^ ^ ^ ^ ^ ^ ^ ^ ^
            // ^ ^ ^         END OF PROMO CODE SECTION             ^ ^ ^
            // ^ ^ ^ ^ ^ ^ ^ ^ ^ ^ ^ ^ ^ ^ ^ ^ ^ ^ ^ ^ ^ ^ ^ ^ ^ ^ ^ ^ ^ ^

            delete validCodes["___PLACEHOLDER___"]; // Remove placeholder

            const redeemCoinStorageKey = "redeemCoins";
            const usedCodesStorageKey = "usedCodes";

            // --- DOM Element Selection ---
            const promoCodeInput = document.getElementById("promoCodeInput");
            const redeemButton = document.getElementById("redeemButton");
            const homeButton = document.getElementById("homeButton");
            const messageOutput = document.getElementById("messageOutput");
            const topCoinBalanceDisplay = document.getElementById("topCoinBalance"); // Get top bar balance display

            // --- Helper Functions ---

            // Function to get current coin balance
            function getCurrentBalance() {
                return parseInt(localStorage.getItem(redeemCoinStorageKey) || 0);
            }

             // Function to update balance display everywhere
             function updateBalanceDisplay(balance) {
                  const formattedBalance = balance.toLocaleString();
                  if(topCoinBalanceDisplay) { // Check if element exists
                       topCoinBalanceDisplay.innerText = formattedBalance;
                  }
                  // You could add another balance display within the container if needed
             }

            // Function to display messages
            function displayMessage(text, type = 'success') {
                messageOutput.innerText = text;
                messageOutput.className = `message ${type} show`;
                 // Optional: Hide message after a few seconds
                 // setTimeout(hideMessage, 4000);
            }

            // Function to hide the message area
            function hideMessage() {
                messageOutput.className = 'message';
            }

            // Function to handle promo code redemption (Core logic unchanged)
            function redeemCode() {
                hideMessage();
                const enteredCode = promoCodeInput.value.trim().toUpperCase();

                if (!enteredCode) {
                    displayMessage("Please enter a code.", 'error');
                    promoCodeInput.focus(); // Focus input if empty
                    return;
                }

                let usedCodes = JSON.parse(localStorage.getItem(usedCodesStorageKey)) || [];

                if (usedCodes.includes(enteredCode)) {
                    displayMessage("Code already used!", 'error');
                    return;
                }

                if (validCodes.hasOwnProperty(enteredCode)) {
                    const reward = validCodes[enteredCode];
                    let currentBalance = getCurrentBalance();
                    const newBalance = currentBalance + reward;

                    localStorage.setItem(redeemCoinStorageKey, newBalance);
                    usedCodes.push(enteredCode);
                    localStorage.setItem(usedCodesStorageKey, JSON.stringify(usedCodes));

                    updateBalanceDisplay(newBalance); // Update display immediately
                    displayMessage(`Successfully Redeemed! +${reward} Coins`);
                    promoCodeInput.value = ''; // Clear input on success
                } else {
                    displayMessage("Invalid promo code!", 'error');
                }
            }

            // --- Event Listeners ---
            redeemButton.addEventListener('click', redeemCode);
            homeButton.addEventListener('click', () => {
                window.location.href = 'Surveys.html'; // Ensure correct path
            });
            promoCodeInput.addEventListener('keypress', (event) => {
                if (event.key === 'Enter') {
                    event.preventDefault();
                    redeemCode();
                }
            });
             // Optional: Hide message when user starts typing again
             promoCodeInput.addEventListener('input', hideMessage);

             // --- Initial Setup ---
             updateBalanceDisplay(getCurrentBalance()); // Display initial balance

        }); // End of DOMContentLoaded
    </script>
</body>
</html>
